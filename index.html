<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä»Šæ—¥ç¦»èŒæŒ‡æ•°è®¡ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');

        * {
            font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f0e8 0%, #e8ddd4 100%);
            min-height: 100vh;
        }

        /* è‡ªå®šä¹‰æ»‘å—æ ·å¼ */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 12px;
            border-radius: 6px;
            background: #fff;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(255, 154, 158, 0.4);
            transition: transform 0.2s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        input[type="range"]::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(255, 154, 158, 0.4);
        }

        /* ç»“æœå•å¡ç‰‡æ ·å¼ */
        .result-card {
            background: linear-gradient(145deg, #ffffff 0%, #fefefe 100%);
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #ff9a9e 0%, #fecfef 50%, #ffecd2 100%);
        }

        /* ç­‰çº§å¾½ç«  */
        .level-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .level-danger {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        .level-warning {
            background: linear-gradient(135deg, #ffa502, #ff7f50);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 165, 2, 0.4);
        }

        .level-normal {
            background: linear-gradient(135deg, #ffa502, #ffcd3c);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 165, 2, 0.3);
        }

        .level-good {
            background: linear-gradient(135deg, #7bed9f, #2ed573);
            color: white;
            box-shadow: 0 4px 12px rgba(46, 213, 115, 0.4);
        }

        /* æ ‡ç­¾æ ·å¼ */
        .tag {
            display: inline-block;
            padding: 4px 10px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 11px;
            color: #666;
            margin: 2px;
        }

        /* è¿›åº¦æ¡ */
        .progress-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff9a9e 0%, #ff6b6b 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* æ•°æ®å±•ç¤ºå¡ç‰‡ */
        .data-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 16px;
            padding: 12px;
            border: 1px solid #e9ecef;
        }

        /* æ¯’é¸¡æ±¤å¡ç‰‡ */
        .quote-card {
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            border-left: 4px solid #ff6b6b;
            position: relative;
        }

        .quote-card::before {
            content: '"';
            position: absolute;
            top: -5px;
            left: 10px;
            font-size: 40px;
            color: #ff6b6b;
            opacity: 0.3;
            font-family: Georgia, serif;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        /* æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .btn-primary {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #ffecd2 100%);
            background-size: 200% 200%;
            animation: gradient 3s ease infinite;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 154, 158, 0.4);
        }

        /* ç¦»èŒæŒ‡æ•°å¤§æ•°å­— */
        .index-number {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff9a9e 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        /* è£…é¥°å›¾æ ‡ */
        .decoration-icon {
            position: absolute;
            opacity: 0.1;
            font-size: 80px;
        }

        /* é—ªçƒåŠ¨ç”» */
        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        .blink {
            animation: blink 1s infinite;
        }

        /* éšè—æ»šåŠ¨æ¡ä½†ä¿æŒæ»šåŠ¨ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- ä¸»å®¹å™¨ -->
    <div id="app" class="max-w-md mx-auto px-4 py-8 min-h-screen flex flex-col">
        <!-- ç¬¬ä¸€å±ï¼šè¾“å…¥åŒº -->
        <div id="inputScreen" class="flex-1 flex flex-col">
            <!-- æ ‡é¢˜åŒºåŸŸ -->
            <div class="text-center mb-8 fade-in">
                <div class="text-5xl mb-4">ğŸ’Š</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ä»Šå¤©ï¼Œæƒ³ç¦»èŒäº†å—ï¼Ÿ</h1>
                <p class="text-gray-500 text-sm">æ‰“å·¥ç²¾ç¥çŠ¶æ€å¿«é€Ÿæ£€æµ‹</p>
            </div>

            <!-- è¾“å…¥å¡ç‰‡ -->
            <div class="bg-white rounded-3xl shadow-lg p-6 mb-6 fade-in" style="animation-delay: 0.1s;">
                <!-- å¼€ä¼šæ—¶é•¿ -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <label class="flex items-center gap-2 text-gray-700 font-medium">
                            <span class="text-2xl">ğŸª‘</span>
                            <span>å¼€ä¼šæ—¶é•¿ï¼ˆåç‰¢æ—¶é—´ï¼‰</span>
                        </label>
                        <span class="text-2xl font-bold" style="color: #ff9a9e;">
                            <span id="meetingValue">2</span>h
                        </span>
                    </div>
                    <input type="range" id="meeting" min="0" max="8" value="2" class="w-full">
                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                        <span>0h</span>
                        <span>8h</span>
                    </div>
                </div>

                <!-- è¢«æ‰¾èŒ¬æ¬¡æ•° -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <label class="flex items-center gap-2 text-gray-700 font-medium">
                            <span class="text-2xl">ğŸ˜¤</span>
                            <span>è¢«è€æ¿/å®¢æˆ·åˆ›æ¬¡æ•°</span>
                        </label>
                        <span class="text-2xl font-bold" style="color: #ff9a9e;">
                            <span id="criticismValue">1</span>æ¬¡
                        </span>
                    </div>
                    <input type="range" id="criticism" min="0" max="10" value="1" class="w-full">
                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                        <span>0æ¬¡</span>
                        <span>10æ¬¡</span>
                    </div>
                </div>

                <!-- å’–å•¡æ‘„å…¥ -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <label class="flex items-center gap-2 text-gray-700 font-medium">
                            <span class="text-2xl">â˜•</span>
                            <span>å’–å•¡/å¥¶èŒ¶ç»­å‘½å‰‚é‡</span>
                        </label>
                        <span class="text-2xl font-bold" style="color: #ff9a9e;">
                            <span id="coffeeValue">1</span>æ¯
                        </span>
                    </div>
                    <input type="range" id="coffee" min="0" max="5" value="1" class="w-full">
                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                        <span>0æ¯</span>
                        <span>5æ¯</span>
                    </div>
                </div>

                <!-- ç¡çœ æ—¶é•¿ -->
                <div class="mb-2">
                    <div class="flex justify-between items-center mb-3">
                        <label class="flex items-center gap-2 text-gray-700 font-medium">
                            <span class="text-2xl">ğŸ˜´</span>
                            <span>æ˜¨æ™šå®é™…ç¡çœ </span>
                        </label>
                        <span class="text-2xl font-bold" style="color: #ff9a9e;">
                            <span id="sleepValue">6</span>h
                        </span>
                    </div>
                    <input type="range" id="sleep" min="0" max="12" value="6" class="w-full">
                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                        <span>0h</span>
                        <span>12h</span>
                    </div>
                </div>
            </div>

            <!-- ç‚¹å‡»ç¡®è¯ŠæŒ‰é’® -->
            <button id="calculateBtn" class="btn-primary text-white font-bold text-lg py-4 rounded-2xl shadow-lg transition-all duration-300 pulse-animation fade-in" style="animation-delay: 0.2s;">
                ç”Ÿæˆæˆ‘çš„é‰´å®šæŠ¥å‘Š ğŸ”®
            </button>
        </div>

        <!-- ç¬¬äºŒå±ï¼šç»“æœåŒºï¼ˆåˆå§‹éšè—ï¼‰ -->
        <div id="resultScreen" class="hidden flex-1 flex flex-col">
            <!-- ç»“æœå¡ç‰‡ -->
            <div id="receiptArea" class="result-card rounded-3xl p-5 mb-6 fade-in relative">
                <!-- è£…é¥°å›¾æ ‡ -->
                <div class="decoration-icon" style="top: 20px; right: 20px;">ğŸ’Š</div>
                <div class="decoration-icon" style="bottom: 40px; left: 10px;">ğŸ’Š</div>

                <!-- é¡¶éƒ¨æ ‡é¢˜åŒº -->
                <div class="text-center mb-4 relative">
                    <div class="text-3xl mb-2">ğŸ¥</div>
                    <h2 class="text-lg font-bold text-gray-800">æ‰“å·¥ç²¾ç¥çŠ¶æ€é‰´å®šæŠ¥å‘Š</h2>
                    <p class="text-xs text-gray-400 mt-1" id="diagnosisDate"></p>
                    <div class="mt-2" id="levelBadge"></div>
                </div>

                <!-- æ ¸å¿ƒæŒ‡æ•°å±•ç¤º -->
                <div class="text-center my-6 relative">
                    <div class="text-xs text-gray-500 mb-2 tracking-wide">ä»Šæ—¥ç¦»èŒå†²åŠ¨æŒ‡æ•°</div>
                    <div class="index-number" id="resignationIndex">0%</div>
                    <div class="mt-2">
                        <div class="progress-bar w-48 mx-auto">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="text-sm font-bold mt-3" id="indexLevel"></div>
                </div>

                <!-- ç—‡çŠ¶æ ‡ç­¾ -->
                <div class="mb-4">
                    <div class="text-xs text-gray-500 mb-2">ğŸ“Š ä»Šæ—¥ç—‡çŠ¶æ ‡ç­¾</div>
                    <div class="flex flex-wrap" id="symptomTags">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ•°æ®å¡ç‰‡ -->
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="data-card text-center">
                        <div class="text-2xl mb-1">ğŸ˜¤</div>
                        <div class="text-xs text-gray-500">è¢«åˆ›æ¬¡æ•°</div>
                        <div class="text-lg font-bold text-gray-800" id="criticismDisplay">0</div>
                    </div>
                    <div class="data-card text-center">
                        <div class="text-2xl mb-1">â˜•</div>
                        <div class="text-xs text-gray-500">ç»­å‘½å‰‚é‡</div>
                        <div class="text-lg font-bold text-gray-800" id="coffeeDisplay">0</div>
                    </div>
                    <div class="data-card text-center">
                        <div class="text-2xl mb-1">ğŸª‘</div>
                        <div class="text-xs text-gray-500">åç‰¢æ—¶é•¿</div>
                        <div class="text-lg font-bold text-gray-800" id="meetingDisplay">0h</div>
                    </div>
                    <div class="data-card text-center">
                        <div class="text-2xl mb-1">ğŸ˜´</div>
                        <div class="text-xs text-gray-500">ç»­å‘½ç¡çœ </div>
                        <div class="text-lg font-bold text-gray-800" id="sleepDisplay">0h</div>
                    </div>
                </div>

                <!-- æ¯’é¸¡æ±¤å¡ç‰‡ -->
                <div class="quote-card rounded-2xl p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2 flex items-center gap-1">
                        <span>ğŸ’Š</span>
                        <span>AI åŒ»å¸ˆå¤„æ–¹</span>
                    </div>
                    <div class="text-sm font-medium text-gray-800 leading-relaxed relative z-10" id="toxicQuote"></div>
                </div>

                <!-- åº•éƒ¨ä¿¡æ¯ -->
                <div class="text-center pt-3 border-t border-gray-100">
                    <div class="text-xs text-gray-400">
                        é‰´å®šæœºæ„ï¼šç¦»èŒè‡ªæ•‘ä¸­å¿ƒ Â· AIç²¾ç¥ç§‘
                    </div>
                    <div class="text-xs text-gray-300 mt-1">
                        æœ¬æŠ¥å‘Šä»…ä¾›å‚è€ƒï¼Œå»ºè®®ç›´æ¥ç¦»èŒ
                    </div>
                </div>
            </div>

            <!-- æŒ‰é’®ç»„ -->
            <div class="space-y-3">
                <button id="saveBtn" class="w-full bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold py-4 rounded-2xl shadow-lg transition-all hover:shadow-xl active:scale-95">
                    <span class="text-lg">ğŸ“¸ æˆªå›¾å‘æœ‹å‹åœˆ</span>
                </button>
                <button id="retryBtn" class="w-full bg-white text-gray-700 font-bold py-3 rounded-xl shadow-md transition-all hover:shadow-lg active:scale-95">
                    å†æµ‹ä¸€æ¬¡ ğŸ”„
                </button>
            </div>

            <!-- åº•éƒ¨å¹¿å‘Š -->
            <div class="text-center mt-5 px-4">
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-3 border border-purple-100">
                    <div class="text-xs text-purple-600 font-medium">
                        ğŸ’¡ æƒ³è¦ç¦»èŒè°ˆåˆ¤è¯æœ¯ï¼Ÿå…³æ³¨ã€èŒåœºæ‘¸é±¼èŒ¶ã€‘
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ›´çŠ€åˆ©çš„æ¯’é¸¡æ±¤åº“ - 95å00åç½‘æ„Ÿæ–‡æ¡ˆ
        const toxicQuotes = [
            "åˆ«å¿äº†ï¼Œè¿™å°±æ˜¯ä¸ªç­ï¼Œåˆä¸æ˜¯ä½ çš„å‘½",
            "å·¥èµ„æ˜¯ç²¾ç¥æŸå¤±è´¹ï¼Œä¸æ˜¯åŠ³åŠ¨æŠ¥é…¬",
            "ä¸Šç­å°±åƒè¢«PUAï¼Œè¿˜è¦è‡ªæˆ‘æ„ŸåŠ¨ï¼Ÿ",
            "è€æ¿ç”»é¥¼ä½ åƒé¥¼ï¼Œæœ€åæ¶ˆåŒ–ä¸è‰¯çš„æ˜¯ä½ ",
            "ä½ çš„ç¦»èŒæŒ‡æ•°å·²çˆ†è¡¨ï¼Œå»ºè®®ç›´æ¥æ¶¦",
            "åœ°çƒä¸çˆ†ç‚¸ï¼Œä½ å°±å¾—æ‰“å·¥ï¼Ÿè¿™ç­éä¸Šä¸å¯ï¼Ÿ",
            "å·¥ä½œå¯ä»¥æ¢ï¼Œä½†ç²¾ç¥çŠ¶æ€å¾ˆéš¾æ¢å¤",
            "ä¸å…¶åœ¨è¿™å†…è€—ï¼Œä¸å¦‚ç›´æ¥è·‘è·¯",
            "è®°ä½ï¼šå·¥ä½œæ˜¯æš‚æ—¶çš„ï¼Œå‘é™…çº¿åç§»æ˜¯æ°¸ä¹…çš„",
            "è¿™ç ´ç­è°çˆ±ä¸Šè°ä¸Šï¼Œåæ­£æˆ‘ä¸ä¸Šäº†",
            "å»ºè®®ç«‹å³æ‰“å¼€æ‹›è˜è½¯ä»¶ï¼Œè¡ŒåŠ¨åŠ›æ‹‰æ»¡",
            "å†å¿ä¸‹å»ï¼ŒçœŸçš„ä¼šå˜æˆç¤¾ç•œæœ¬ç•œ",
            "è€æ¿çš„å¿«ä¹å»ºç«‹åœ¨ä½ çš„ç—›è‹¦ä¹‹ä¸Šï¼Œæ‡‚ï¼Ÿ",
            "ç¦»èŒä¸æ˜¯é€ƒé¿ï¼Œæ˜¯åŠæ—¶æ­¢æŸ",
            "ä½ é‚£ä¹ˆä¼˜ç§€ï¼Œä¸ºä»€ä¹ˆè¦åœ¨è¿™å—å§”å±ˆï¼Ÿ",
            "ä¸Šç­å°±åƒä¾¿ç§˜ï¼Œè´¹åŠ²åˆä¸èˆ’æœ",
            "æ¯å¤©å«é†’ä½ çš„ä¸æ˜¯æ¢¦æƒ³ï¼Œæ˜¯è¿˜è¦è¿˜çš„èŠ±å‘—",
            "è¿™ç­ä¸Šå¾—ï¼Œæˆ‘éƒ½å¿ƒç–¼æˆ‘è‡ªå·±",
            "ä½ çš„æ‰åé…å¾—ä¸Šæ›´å¥½çš„å¹³å°ï¼Œè€Œä¸æ˜¯è¿™é‡Œ",
            "è¦ä¹ˆå¿ï¼Œè¦ä¹ˆæ»šï¼Œè¦ä¹ˆå¿ç€å¿ç€å°±æ»šäº†"
        ];

        // ç—‡çŠ¶æ ‡ç­¾åº“
        const symptomTags = {
            high: [
                "ç²¾ç¥ç¦»èŒä¸­", "å·²ç¡®è¯Šä¸ºç¤¾ç•œ", "æ€¥éœ€å¥¶èŒ¶ç»­å‘½",
                "æ¯å¤©éƒ½åœ¨æƒ³ç¦»èŒ", "æ‰“å·¥é­‚å·²ç‡ƒå°½", "ç²¾ç¥çŠ¶æ€ç¾ä¸½",
                "ä¸è€æ¿åŠ¿ä¸ä¸¤ç«‹", "åœ¨è¿™ä¸ªç­ä¸€å¤©éƒ½å¾…ä¸ä¸‹å»äº†"
            ],
            medium: [
                "é—´æ­‡æ€§æƒ³ç¦»èŒ", "è¿˜èƒ½å†è‹Ÿä¸€è‹Ÿ",
                "å’–å•¡ç»­å‘½ä¸­", "æ‰“å·¥äººæ‰“å·¥é­‚",
                "æ‘¸é±¼ä¸“ä¸šæˆ·", "å¸¦è–ªç—›è‹¦ä¸­"
            ],
            low: [
                "æ‰“å·¥äººå¿ƒæ€", "è¿˜èƒ½åšæŒ",
                "ä½›ç³»æ‰“å·¥", "å¿«ä¹æ‘¸é±¼",
                "èŒåœºè€æ²¹æ¡", "æƒ…ç»ªç¨³å®š"
            ]
        };

        // ç­‰çº§é…ç½®
        const levelConfig = {
            danger: {
                text: "âš ï¸ å±é™©ï¼ç¦»èŒå€¾å‘æé«˜",
                class: "level-danger",
                tags: symptomTags.high
            },
            warning: {
                text: "ğŸ”¥ é¢„è­¦ï¼æ­£åœ¨ç¦»èŒè¾¹ç¼˜",
                class: "level-warning",
                tags: symptomTags.high
            },
            normal: {
                text: "ğŸ˜ æ™®é€šç¤¾ç•œçŠ¶æ€",
                class: "level-normal",
                tags: symptomTags.medium
            },
            good: {
                text: "âœ¨ æ‰“å·¥çŠ¶æ€ç¨³å®š",
                class: "level-good",
                tags: symptomTags.low
            }
        };

        // è·å–DOMå…ƒç´ 
        const meetingSlider = document.getElementById('meeting');
        const criticismSlider = document.getElementById('criticism');
        const coffeeSlider = document.getElementById('coffee');
        const sleepSlider = document.getElementById('sleep');

        const meetingValue = document.getElementById('meetingValue');
        const criticismValue = document.getElementById('criticismValue');
        const coffeeValue = document.getElementById('coffeeValue');
        const sleepValue = document.getElementById('sleepValue');

        const calculateBtn = document.getElementById('calculateBtn');
        const saveBtn = document.getElementById('saveBtn');
        const retryBtn = document.getElementById('retryBtn');

        const inputScreen = document.getElementById('inputScreen');
        const resultScreen = document.getElementById('resultScreen');
        const receiptArea = document.getElementById('receiptArea');

        // æ›´æ–°æ»‘å—å€¼æ˜¾ç¤º
        function updateSliderValue(slider, display, unit) {
            display.textContent = slider.value;
        }

        meetingSlider.addEventListener('input', () => updateSliderValue(meetingSlider, meetingValue));
        criticismSlider.addEventListener('input', () => updateSliderValue(criticismSlider, criticismValue));
        coffeeSlider.addEventListener('input', () => updateSliderValue(coffeeSlider, coffeeValue));
        sleepSlider.addEventListener('input', () => updateSliderValue(sleepSlider, sleepValue));

        // è®¡ç®—ç¦»èŒæŒ‡æ•°
        function calculateResignationIndex() {
            const meeting = parseInt(meetingSlider.value);
            const criticism = parseInt(criticismSlider.value);
            const coffee = parseInt(coffeeSlider.value);
            const sleep = parseInt(sleepSlider.value);

            // ç®—æ³•ï¼šå¼€ä¼š*10 + æ‰¾èŒ¬*20 + å’–å•¡*10 + (8-ç¡çœ )*10
            let index = (meeting * 10) + (criticism * 20) + (coffee * 10) + ((8 - sleep) * 10);

            // ç¡®ä¿ä¸ä½äº0
            index = Math.max(0, index);

            // å¦‚æœè¶…è¿‡100ï¼Œæ˜¾ç¤º999%
            if (index > 100) {
                return 999;
            }

            return Math.round(index);
        }

        // è·å–ç­‰çº§é…ç½®
        function getLevelConfig(index) {
            if (index >= 999 || index >= 80) return levelConfig.danger;
            if (index >= 60) return levelConfig.warning;
            if (index >= 40) return levelConfig.normal;
            return levelConfig.good;
        }

        // éšæœºè·å–æ ‡ç­¾
        function getRandomTags(tagsArray, count = 4) {
            const shuffled = [...tagsArray].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult() {
            const index = calculateResignationIndex();
            const config = getLevelConfig(index);

            // è®¾ç½®æ—¥æœŸ
            const now = new Date();
            const dateStr = `${now.getFullYear()}.${String(now.getMonth() + 1).padStart(2, '0')}.${String(now.getDate()).padStart(2, '0')}`;
            document.getElementById('diagnosisDate').textContent = `é‰´å®šæ—¶é—´ï¼š${dateStr}`;

            // è®¾ç½®ç­‰çº§å¾½ç« 
            const levelBadge = document.getElementById('levelBadge');
            levelBadge.innerHTML = `<span class="level-badge ${config.class}">${config.text}</span>`;

            // è®¾ç½®æŒ‡æ•°
            const indexElement = document.getElementById('resignationIndex');
            indexElement.textContent = index + '%';

            // è®¾ç½®è¿›åº¦æ¡
            const progressFill = document.getElementById('progressFill');
            const progressValue = Math.min(index, 100);
            progressFill.style.width = progressValue + '%';

            // è®¾ç½®æŒ‡æ•°æè¿°
            document.getElementById('indexLevel').textContent = config.text;

            // è®¾ç½®ç—‡çŠ¶æ ‡ç­¾
            const tags = getRandomTags(config.tags, 4);
            const tagsContainer = document.getElementById('symptomTags');
            tagsContainer.innerHTML = tags.map(tag => `<span class="tag">#${tag}</span>`).join('');

            // è®¾ç½®æ•°æ®å¡ç‰‡
            document.getElementById('criticismDisplay').textContent = criticismSlider.value + 'æ¬¡';
            document.getElementById('coffeeDisplay').textContent = coffeeSlider.value + 'æ¯';
            document.getElementById('meetingDisplay').textContent = meetingSlider.value + 'h';
            document.getElementById('sleepDisplay').textContent = sleepSlider.value + 'h';

            // è®¾ç½®éšæœºæ¯’é¸¡æ±¤
            const randomQuote = toxicQuotes[Math.floor(Math.random() * toxicQuotes.length)];
            document.getElementById('toxicQuote').textContent = randomQuote;

            // åˆ‡æ¢å±å¹•
            inputScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            resultScreen.classList.add('fade-in');
        }

        // ä¿å­˜å›¾ç‰‡
        async function saveImage() {
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<span class="text-lg">â³ ç”Ÿæˆä¸­...</span>';
            saveBtn.disabled = true;

            try {
                const canvas = await html2canvas(receiptArea, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false,
                    useCORS: true
                });

                // è½¬æ¢ä¸ºå›¾ç‰‡
                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.download = `æ‰“å·¥ç²¾ç¥çŠ¶æ€é‰´å®š_${new Date().getTime()}.png`;
                    link.href = url;
                    link.click();
                    URL.revokeObjectURL(url);

                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                });
            } catch (error) {
                console.error('ä¿å­˜å¤±è´¥:', error);
                alert('ä¿å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥æˆªå›¾ä¿å­˜');
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        }

        // é‡ç½®
        function reset() {
            resultScreen.classList.add('hidden');
            inputScreen.classList.remove('hidden');
            inputScreen.classList.add('fade-in');

            // é‡ç½®æ»‘å—
            meetingSlider.value = 2;
            criticismSlider.value = 1;
            coffeeSlider.value = 1;
            sleepSlider.value = 6;

            // æ›´æ–°æ˜¾ç¤º
            meetingValue.textContent = '2';
            criticismValue.textContent = '1';
            coffeeValue.textContent = '1';
            sleepValue.textContent = '6';
        }

        // äº‹ä»¶ç»‘å®š
        calculateBtn.addEventListener('click', showResult);
        saveBtn.addEventListener('click', saveImage);
        retryBtn.addEventListener('click', reset);
    </script>
</body>
</html>